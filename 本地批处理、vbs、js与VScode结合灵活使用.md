# 本地批处理、vbs、js与VScode结合灵活使用

因为VScode方便的整合了命令行，并且支持批处理文件的编辑和快速调用。所以完全可以整合编写一些功能。

![1555232486111](U:\本地批处理、vbs、js与VScode结合灵活使用.assets\1555232486111.png)

批处理更接近系统底层，可以用最少的代码实现很多文件夹、文件操作功能。

## vsb脚本文件使用

利用vscode的文件夹视图区（资源管理器）可以快速创建本地vbs文件，然后打开快速编辑保存代码，然后有可以在下方终端快速调用执行，所以vscode是前所未有的本地脚本编辑执行环境，方便至极。

![1555232838165](U:\本地批处理、vbs、js与VScode结合灵活使用.assets\1555232838165.png)

## 本地js脚本文件使用

###  一个坑

> 微软本地创建的js文件由Wscript.exe解释执行，并且其代码并非网页中使用的javascript，而是由微软实现的ECMAScript版本JScript。所以完全按照javascript写法会出现错误。

像下面的代码就会报错

```js
alert("hello");
```

因为alert是浏览器window对象下的方法，而在本地执行JScript时，是由Wscript.exe解释执行，此时不再存在浏览器window对象，也就更不能使用alert方法了。

本地JScript正确弹出信息框的写法是

```Js
WScript.Echo("hello");
```

弹出的信息框，可以明显看到不同：

![1555234155781](U:\本地批处理、vbs、js与VScode结合灵活使用.assets\1555234155781.png)

### 研究wscript对象而非JScript文档

JScript其实是可以用于浏览器网页脚本的，但是作为本地JS脚本文件来说，最需要研究和掌握、理解的是wscript对象以及FSO的内容。

### 本地脚本文件的两种使用方式

无论是批处理、vsb还是本地js脚本文件，其实都可以有两种基本使用方式，一种是无参数执行，另一种是带参数执行。

#### 无参数执行

这种执行方式就是不带任何参数。实际运行方法包括命令行直接调用文件名和双击脚本文件执行两种。

#### 带参数执行

带参数执行实际操作中也有两种运行方式，在命令行输入文件名和参数执行以及在Windows资源管理器中拖放文件、文件夹等到脚本文件上执行。

其实脚本文件的参数不一定是文件名，也可以是其他。

每个脚本文件就像一个函数一样，接收参数，处理，返回结果。

## 思维扩展

### 自己编写控制台程序

本地脚本文件、批处理都是一种解释执行程序。编写简单，灵活易用。但是其实还有一种方式扩展命令行使用，那就是编写Windows的控制台程序。像Nodejs等。

按照思路来说，编写控制台程序的潜力和功用将会比脚本大的多，可以实现更复杂的功能，使用更多的库。

### 最佳编写工具SharpDevelop

 通过SharpDevelop你可以使用很多主流语言来编写控制台程序，甚至是VB.net或C#。并且这个IDE安装包很小，没有什么收费破解之类的问题。

![1555236067307](U:\本地批处理、vbs、js与VScode结合灵活使用.assets\1555236067307.png)

![1555236085457](U:\本地批处理、vbs、js与VScode结合灵活使用.assets\1555236085457.png)

编译后找到.exe文件就可以拷贝到某目录（如VScode具体项目文件夹）下进行命令行调用。

当然也可以打包安装程序进行发布、下载、安装使用。

```powershell
u:\codes\bats>cc
Hello World!
Press any key to continue . . .
```

同样的通过主函数传参，可以完成功能的丰富化。